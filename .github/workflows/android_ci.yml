name: Android CI

on:
  push:
    branches: [ "main", "dgddgd314", "feature/**" ] # main이나 dgddgd314에 코드가 올라갈 때
  pull_request:
    branches: [ "main" ] # PR(합치기 요청)이 생성될 때

jobs:
  build:
    runs-on: ubuntu-latest # GitHub이 제공하는 가상 컴퓨터(리눅스)에서 실행

    steps:
      - name: Checkout Code
        uses: actions/checkout@v4 # 내 코드를 가상 컴퓨터로 복사

      - name: Set up JDK 17
        uses: actions/setup-java@v4 # 빌드에 필요한 자바 설치
        with:
          java-version: '17'
          distribution: 'temurin'
          cache: gradle # 빌드 속도를 높이기 위해 캐시 사용

      - name: Grant Permission
        run: chmod +x gradlew # 실행 권한 부여

      # [목표 1] 빌드 검증
      - name: Build Debug APK
        run: ./gradlew assembleDebug

      # [목표 2 & 3] 결과물 업로드
      - name: Upload Artifact
        uses: actions/upload-artifact@v4
        with:
          name: ToyProject-Debug-APK # 결과물 이름
          path: app/build/outputs/apk/debug/app-debug.apk # 로컬에서 빌드된 파일 위치
